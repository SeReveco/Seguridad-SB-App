<ion-content id="main-content">
  <div class="page-content">

    <!-- MAPA -->
    <div id="map"></div>

    <!-- BARRA FLOTANTE: REPORTAR + GPS -->
    <div class="reportar-wrapper">
      <ion-button
        expand="block"
        class="reportar-btn"
        (click)="abrirFormulario()">
        <ion-icon name="megaphone-outline" slot="start"></ion-icon>
        Denunciar
      </ion-button>

      <ion-button
        class="gps-btn"
        (click)="goToUbicacionActual()">
        <ion-icon name="locate-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </div>

    <!-- MODAL FORMULARIO (puede ser denuncia/alerta, como tú prefieras) -->
    <ion-modal [isOpen]="mostrarFormulario" (didDismiss)="cerrarFormulario()">
      <ng-template>
        <div class="reportar-form-container">
          <form (ngSubmit)="enviarDenuncia()" #alertaForm="ngForm">

            <ion-item>
              <ion-label position="floating">Solicitante (opcional)</ion-label>
              <ion-input
                [(ngModel)]="solicitante"
                name="solicitante"
                placeholder="Anónimo si se deja vacío">
              </ion-input>
            </ion-item>

            <ion-item>
              <ion-label position="floating">Tipo de alerta</ion-label>
              <ion-textarea
                [(ngModel)]="tipo"
                name="tipo"
                required>
              </ion-textarea>
            </ion-item>

            <ion-item>
              <ion-label position="floating">Descripción</ion-label>
              <ion-textarea
                [(ngModel)]="descripcion"
                name="descripcion"
                required>
              </ion-textarea>
            </ion-item>

            <div class="form-buttons">
              <ion-button
                type="submit"
                [disabled]="!alertaForm.form.valid">
                <ion-icon name="megaphone-outline" slot="start"></ion-icon>
                Denunciar
              </ion-button>

              <ion-button
                color="medium"
                (click)="cerrarFormulario()">
                Cancelar
              </ion-button>
            </div>

          </form>
        </div>
      </ng-template>
    </ion-modal>

  </div>
</ion-content>

<!-- FOOTER / NAV INFERIOR -->
<ion-footer>
  <ion-toolbar class="bottom-toolbar">
    <div class="footer-nav">

      <!-- MAPA (todos) -->
      <ion-button
        fill="clear"
        routerLink="/home"
        routerLinkActive="active-tab"
        class="footer-button">
        <div class="footer-button-inner">
          <ion-icon name="map-outline"></ion-icon>
          <span>Mapa</span>
        </div>
      </ion-button>

      <!-- FISCALIZACIÓN: SOLO trabajadores -->
      <ion-button
        *ngIf="tipoUsuario === 'trabajador'"
        fill="clear"
        routerLink="/fiscalizacion"
        routerLinkActive="active-tab"
        class="footer-button">
        <div class="footer-button-inner">
          <ion-icon name="alert-circle-outline"></ion-icon>
          <span>Fiscalización</span>
        </div>
      </ion-button>

      <!-- SOLICITUD (todos) -->
      <ion-button
        fill="clear"
        routerLink="/solicitud"
        routerLinkActive="active-tab"
        class="footer-button">
        <div class="footer-button-inner">
          <ion-icon name="document-text-outline"></ion-icon>
          <span>Solicitud</span>
        </div>
      </ion-button>

      <!-- MENÚ (todos) -->
      <ion-button
        fill="clear"
        (click)="openMenu()"
        class="footer-button">
        <div class="footer-button-inner">
          <ion-icon name="menu-outline"></ion-icon>
          <span>Menú</span>
        </div>
      </ion-button>

    </div>
  </ion-toolbar>
</ion-footer>